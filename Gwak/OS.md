# OS

[TOC]

## Lecture 1. Computer System Overview/ 운영체제 강의

개요

컴퓨터 시스템은 CPU, GPU, LAN 등의 HW와 

이를 효율적으로 운영(관리)해줄 OS가 필요하다.

![OS](C:\Users\multicampus\Desktop\selfstudy\ABCS\OS\OS\Gwak\OS.assets\OS.PNG)



#### 1. 컴퓨터 하드웨어

1. 프로세서
   - cpu, 그래픽카드(gpu), 응용 전용 처리장치 등
2. 메모리
   - 주 기억장치, 보조 기억장치 등
3. 주변장치
   - 키보드/ 마우스
   - 모니터, 프린터
   - 네트워크 모뎀 등



##### 1) 프로세서

컴퓨터의 두뇌 (중앙처리장치)

- 연산 수행
- 컴퓨터의 모든 장치의 동작 제어
- 프로세서는 **레지스터**, **연산장치** 와 이를 제어하는 **제어장치**로 구성되어 있다.

\* **레지스터**

- 프로세서 내부에 있는 메모리

  - 프로세서가 사용할 데이터 저장
  - 컴퓨터에서 가장 빠른 메모리

- 레지스터의 종류

  - 용도에 따른 분류: 전용 레지스터, 범용 레지스터

  - 사용자가 정보 변경 가능 여부에 따른 분류: **사용자 가시** 레지스터, **사용자 불가시** 레지스터

  - 저장하는 정보의 종류에 따른 분류: 데이터 레지스터 ,주소 레지스터, 상태 레지스터

    `사용자 가시 레지스터`

    - 데이터 레지스터: 데이터를 저장
    - 주소 레지스터: 주소를 저장 - 기준 주소 레지스터, 인덱스 레지스터, 스택 포인터 레지스터

    `사용자 불가시 레지스터` - 일반적으로 전용레지스터가 포함

    - 프로그램 카운터: 다음에 실행할 명령어의 주소를 보관하는 레지스터
    - 명령어 레지스터: 현재 실행하는 명령어를 보관하는 레지스터
    - 누산기: 데이터를 일시적으로 저장하는 레지스터
    - 메모리 주소 레지스터: 프로세서가 참조하려는 데이터의 주소를 명시하여 메모리에 접근하는 버퍼 레지스터
    - 메모리 버퍼 레지스터: 프로세서가 메모리에서 읽거나 메모리에 저장할 데이터 자체를 보관하는 버퍼 레지스터

##### 2) 운영체제와 프로세서

- 프로세서에게 처리할 작업 할당 및 관리
  - 프로세스 생성 및 관리
- 프로그램의 프로세서 사용 제어
  - 프로그램의 프로세서 사용 시간 관리
  - 복수 프로그램간 사용 시간 조율 등

##### 3) 메모리 (Memory)

- 데이터를 저장하는 장치 (기억장치)

  - 프로그램 (OS, 사용자 sw 등), 사용자 데이터 등

- 메모리의 종류

  - 속도 가격: 레지스터 > 캐시 > 메인 메모리 > 보조기억장치
  - 용량: 보조기억장치 > 메인 메모리 > 캐시 > 레지스터
  - 레지스터 ~ 메인 메모리 : 프로세서가 프로그램과 데이터에 직접 접근할 수 있다.
  - 보조 기억장치 : 프로그램과 데이터를 메인 메모리에 옮겨야 실행할 수 있다.

  1. **주기억장치** (Main memory)

     - 프로세서가 수행할 프로그램과 데이터 저장

     - DRAM을 주로 사용 : 용량이 크고, 가격이 저렴

     - 디스크 입출력 병목현상(I/O bottleneck) 해소

     - 왜 주기억장치와 보조기억장치를 나눠서 관리할까?

       CPU의 속도와 DIsk속도의 발전속도 차이가 어마어마함 => 그 차이를 램으로 메꾸기

       디스크까지 접근하는데 너무 오래걸림(병목현상) => 이를 해소하기위해 램을 사용

  2. **캐시** (Cache)

     - 프로세서 내부에 있는 메모리 (L1, L2 캐시 등)
     - 속도가 빠르고, 가격이 비쌈
     - 메인 메모리의 입출력 병목현상 해소
     - CPU와 메인 메모리의 속도의 간극을 메꾸기 위해 사용
     - 기껏해야 300kbyte 밖에 안되는게 어떻게 속도를 향상시킬까? (어떻게 동작할까?)

     **캐시의 동작**

     - 일반적으로 HW적으로 관리됨

     - **캐시 히트** (Cache hit) : 필요한 데이터 블록이 캐시에 존재(워드단위: 고속) => 메모리를 탐색하는 시간을 줄여줌

     - **캐시 미스** (Cache miss) : 필요한 데이터 블록이 없는 경우(블록단위: 저속) => 시간 손해??

     - **지역성** - 캐시가 동작할 때 속도가 빨라지는 원리

       - 공간적 지역성 (Spatial locality)

         참조한 주소와 인접한 주소를 참조하는 특성

       - 시간적 지역성 (Temporal locality)

         한 번 참조한 주소를 곧 다시 참조하는 특성 예) for문 등의 순환문

       - **지역성은 캐시 적중률(cache hit ratio)과 밀접**

         알고리즘 성능 향상 위한 중요한 요소 중 하나 => 이중 for문 예시 참고

  3. **보조기억 장치**
     - 프로그램과 데이터를 저장
     - 프로세서가 직접 접근할 수 없음(주변장치)
       - 주 기억장치를 거쳐서 접근
       - (프로그램/데이터 > 주기억장치) 인 경우는?
         - 가상 메모리
     - 용량이 크고, 가격이 저렴

##### 4) 메모리와 운영체제

- 메모리 할당 및 관리
  - 프로그램의 요청에 따른 메모리 할당 및 회수
  - 할당된 메모리 관리
- 가상 메모리 관리
  - 가상메모리 생성 및 관리
  - 논리주소 => 물리주소 변환



#### 2. 시스템 버스 (System Bus)

하드웨어들이 데이터 및 신호를 주고 받는 물리적인 통로

1. 종류

   - 데이터 버스 : 프로세서와 메인 메모리, 주변장치 사이에서 데이터를 전송한다.
   - 주소 버스 : 프로세서가 시스템의 구성 요소를 식별하는 주소 정보를 전송한다.
   - 제어 버스 : 프로세서가 시스템의 구성 요소를 제어하는데 사용한다.

2. 동작 원리

   | 시간 | 레지스터 동작 |                             설명                             |
   | :--: | :-----------: | :----------------------------------------------------------: |
   |  1   |   PC -> MAR   | PC에 저장된 주소를 프로세서 내부 버스를 이용하여 MAR에 전달한다. |
   |  2   | Memory -> MBR | MAR에 저장된 주소에 해당하는 메모리 위치에서 명령어를 인출한 후 이 명령어를 MBR에 저장한다. 이 때 제어장치는 메모리에 저장된 내용을 읽도록 제어 신호를 발생시킨다. |
   |      | PC + 1 -> PC  |          다음 명령어를 인출하려고 PC를 증가시킨다.           |
   |  3   |   MBR -> IR   |              MBR에 저장된 내용을 IR에 전달한다.              |

   - PC : 프로그램 카운터
   - MAR : 메모리 주소 레지스터
   - MBR: 메모리 버퍼 레지스터
   - IR : 명령어 레지스터

